<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Zhenyang Hua</title>
  <link rel="stylesheet" href="/assets/global.5d0386ac.css">
<link rel="stylesheet" href="/assets/style.module.edc5e2a1.css"></head>
<body><div id="contentcontainer" class="shadow"><div class="host_1vq48fc" style="background-color: rgb(143, 248, 63);"><header><div class="host_1q8y6om"><a href="#maincontent">skip to main content</a></div><div class="host_216t9o"><h2 class="title_216t9o"><a href="/">Zhenyang Hua</a></h2></div><div class="host_m2uvri"><nav><h2 class="hidden">Main Navigation</h2><ul><li><a href="/">Tools</a></li><li><a href="/writings/1">Writings</a></li></ul></nav></div><div class="host_1c336ft"><span>This is a space that holds a collection of my personal work and ideas</span></div></header></div><main id="maincontent"><div class="post_14b9dxr"><h1 class="title_14b9dxr">Serialize Timestamp To EpochSecond with Jackson</h1><p class="date_14b9dxr">Posted on 11/09/2018</p><div class="summary_14b9dxr"><p>Some REST API only takes a <code>long</code> as its Date field, such as <code>esriFieldTypeDate</code> from ArcGIS Server Rest API. But with the rich functionality, the Java 8 time API provides, it would be silly to use <code>long</code> as the type for our object modeling. This tip shows how to solve this problem.</p>
</div><article><p>I started with using <code>LocalDateTime</code> as the type of the timestamp field I want to use`, but Jackson simply serialize it as it does with any other fields, but what I really want is to serialize it to the epoch second.</p>
<p>Jackson does provide a new library that supports the JSR 310 which is the date and time API. to use that dependency, we need to add the following to maven:</p>
<div class="codeblock">
  <pre>&lt;dependency&gt;
    &lt;groupId&gt;com.fasterxml.jackson.datatype&lt;/groupId&gt;
    &lt;artifactId&gt;jackson-datatype-jsr310&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
</div><p>At this point, the job is not done yet. The <code>LocalDateTime</code> is not an option because it takes a timezone information to convert to the epoch second, unless we provide it, otherwise, we should use the <code>Instant</code> type instead. The <code>Instant</code> class provides the epoch second and the nanosecond of that second. We need to disable the nanosecond from the serialization process so we could get the epoch second.</p>
<p>The following will do the job by using the new Jackson jsr310 dependency we added and disabling the nanosecond in the serialization process.</p>
<div class="codeblock">
  <pre class="language-java"><span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JavaTimeModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token class-name">SerializationFeature</span><span class="token punctuation">.</span>WRITE_DATE_TIMESTAMPS_AS_NANOSECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span></pre>  
</pre></article><h2 class="github_14b9dxr"><a target="_blank" href="https://github.com/zhenyanghua/zhenyanghua.github.io/blob/articles/posts/2018/11/serialize-timestamp-to-epochsecond-with-jackson/index.md">Read on GitHub</a></h2></div></main></div><script type="isodata"></script>
  <script type="module" src="/index.cfb5e8a9.js"></script>
</body>
</html>

